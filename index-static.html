<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IFSI Lannion - R√©visions 2025</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üìö IFSI Lannion 2025</h1>
            <h2>R√©visions - Base de donn√©es des cours</h2>
        </header>

        <main>
            <div class="stats-section">
                <div class="stats-header">
                    <h3>üìä Statistiques des cours</h3>
                    <button class="refresh-btn" onclick="loadCourses()" title="Actualiser les donn√©es">
                        üîÑ
                    </button>
                </div>
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-item">
                        <span class="stat-number" id="totalCourses">-</span>
                        <span class="stat-label">Cours</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalTerms">-</span>
                        <span class="stat-label">Termes</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="totalUE">-</span>
                        <span class="stat-label">UE</span>
                    </div>
                </div>
            </div>

            <div class="courses-section">
                <h3>üìñ Cours disponibles</h3>
                <div class="filters">
                    <select id="ueFilter" onchange="filterCourses()">
                        <option value="">Toutes les UE</option>
                    </select>
                    <input type="text" id="searchInput" placeholder="Rechercher un cours..." onkeyup="filterCourses()">
                </div>
                <div class="courses-grid" id="coursesGrid">
                    <!-- Les cours seront charg√©s ici -->
                </div>
            </div>

            <div class="terms-section" id="termsSection" style="display: none;">
                <h3>üìù Termes et d√©finitions</h3>
                <div class="terms-container" id="termsContainer">
                    <!-- Les termes seront affich√©s ici -->
                </div>
            </div>
        </main>
    </div>

    <script>
        let coursesData = null;
        let filteredCourses = [];

        // Chargement des donn√©es au d√©marrage
        document.addEventListener('DOMContentLoaded', function() {
            loadCourses();
        });

        // Charger les cours depuis le JSON
        async function loadCourses() {
            try {
                const response = await fetch('ifsi_courses_2025-09-23.json');
                const data = await response.json();
                coursesData = data;
                
                updateStats();
                populateUEFilter();
                displayCourses(data.courses);
                
            } catch (error) {
                console.error('Erreur lors du chargement:', error);
                document.getElementById('coursesGrid').innerHTML = 
                    '<div class="error">‚ùå Erreur lors du chargement des donn√©es</div>';
            }
        }

        // Mettre √† jour les statistiques
        function updateStats() {
            if (!coursesData) return;

            const totalCourses = coursesData.courses.length;
            const totalTerms = coursesData.courses.reduce((sum, course) => 
                sum + (course[1].definitions ? course[1].definitions.length : 0), 0);
            
            const ues = [...new Set(coursesData.courses.map(course => course[1].ue))];
            const totalUE = ues.length;

            document.getElementById('totalCourses').textContent = totalCourses;
            document.getElementById('totalTerms').textContent = totalTerms;
            document.getElementById('totalUE').textContent = totalUE;
        }

        // Peupler le filtre UE
        function populateUEFilter() {
            if (!coursesData) return;

            const ues = [...new Set(coursesData.courses.map(course => course[1].ue))];
            const select = document.getElementById('ueFilter');
            
            ues.forEach(ue => {
                const option = document.createElement('option');
                option.value = ue;
                option.textContent = `UE ${ue}`;
                select.appendChild(option);
            });
        }

        // Afficher les cours
        function displayCourses(courses) {
            const grid = document.getElementById('coursesGrid');
            
            if (courses.length === 0) {
                grid.innerHTML = '<div class="no-results">Aucun cours trouv√©</div>';
                return;
            }

            grid.innerHTML = courses.map(course => {
                const [key, data] = course;
                return `
                    <div class="course-card" onclick="showCourseDetails('${key}')">
                        <div class="course-header">
                            <span class="course-ue">UE ${data.ue}</span>
                            <span class="course-date">${data.date || ''}</span>
                        </div>
                        <h4 class="course-title">${data.title}</h4>
                        <div class="course-meta">
                            <span class="course-author">üë§ ${data.author || 'Non d√©fini'}</span>
                            <span class="course-terms">üìù ${data.definitions ? data.definitions.length : 0} termes</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Filtrer les cours
        function filterCourses() {
            if (!coursesData) return;

            const ueFilter = document.getElementById('ueFilter').value;
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            let filtered = coursesData.courses;

            if (ueFilter) {
                filtered = filtered.filter(course => course[1].ue === ueFilter);
            }

            if (searchTerm) {
                filtered = filtered.filter(course => 
                    course[1].title.toLowerCase().includes(searchTerm) ||
                    course[1].author.toLowerCase().includes(searchTerm)
                );
            }

            displayCourses(filtered);
        }

        // Afficher les d√©tails d'un cours
        function showCourseDetails(courseKey) {
            const course = coursesData.courses.find(c => c[0] === courseKey);
            if (!course) return;

            const [key, data] = course;
            const termsSection = document.getElementById('termsSection');
            const termsContainer = document.getElementById('termsContainer');

            termsContainer.innerHTML = `
                <div class="course-details-header">
                    <h4>${data.title}</h4>
                    <button onclick="hideTerms()" class="close-btn">‚úñ</button>
                </div>
                <div class="course-details-meta">
                    <span>UE ${data.ue}</span> ‚Ä¢ 
                    <span>${data.author}</span> ‚Ä¢ 
                    <span>${data.date}</span>
                </div>
                <div class="definitions-list">
                    ${data.definitions ? data.definitions.map((def, index) => `
                        <div class="definition-item">
                            <div class="definition-term">${index + 1}. ${def.term}</div>
                            <div class="definition-text">${def.definition}</div>
                        </div>
                    `).join('') : '<p>Aucune d√©finition disponible</p>'}
                </div>
            `;

            termsSection.style.display = 'block';
            termsSection.scrollIntoView({ behavior: 'smooth' });
        }

        // Masquer les termes
        function hideTerms() {
            document.getElementById('termsSection').style.display = 'none';
        }
    </script>
</body>
</html>